<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Linear GMM · MethodOfMoments.jl</title><meta name="title" content="Linear GMM · MethodOfMoments.jl"/><meta property="og:title" content="Linear GMM · MethodOfMoments.jl"/><meta property="twitter:title" content="Linear GMM · MethodOfMoments.jl"/><meta name="description" content="Documentation for MethodOfMoments.jl."/><meta property="og:description" content="Documentation for MethodOfMoments.jl."/><meta property="twitter:description" content="Documentation for MethodOfMoments.jl."/><meta property="og:url" content="https://junyuan-chen.github.io/MethodOfMoments.jl/stable/man/lineargmm/"/><meta property="twitter:url" content="https://junyuan-chen.github.io/MethodOfMoments.jl/stable/man/lineargmm/"/><link rel="canonical" href="https://junyuan-chen.github.io/MethodOfMoments.jl/stable/man/lineargmm/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MethodOfMoments.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../nonlineargmm/">Generalized Method of Moments</a></li><li class="is-active"><a class="tocitem" href>Linear GMM</a><ul class="internal"><li><a class="tocitem" href="#Example:-Two-Stage-Least-Squares"><span>Example: Two-Stage Least Squares</span></a></li><li><a class="tocitem" href="#GMMIVexample"><span>Example: GMM IV Estimation with Clustering</span></a></li><li><a class="tocitem" href="#Example:-System-of-Simultaneous-Equations"><span>Example: System of Simultaneous Equations</span></a></li><li><a class="tocitem" href="#Example:-Just-Identified-IV-Regression"><span>Example: Just-Identified IV Regression</span></a></li></ul></li><li><a class="tocitem" href="../cugmm/">Continuous-Updating GMM</a></li><li><a class="tocitem" href="../bayesian/">Bayesian Quasi-Likelihood</a></li></ul></li><li><a class="tocitem" href="../../refs/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Linear GMM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Linear GMM</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/junyuan-chen/MethodOfMoments.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/junyuan-chen/MethodOfMoments.jl/blob/main/docs/src/man/lineargmm.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Linear-GMM"><a class="docs-heading-anchor" href="#Linear-GMM">Linear GMM</a><a id="Linear-GMM-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-GMM" title="Permalink"></a></h1><p>An explicit solution for minimizing the criterion function is available when the moment conditions take the special form</p><p class="math-container">\[\mathrm{E}\left[(Y_i - \theta&#39;\mathbf{X}_i) \mathbf{Z}_i\right] = \mathbf{0}\]</p><p>where the residuals from linear equations are orthogonal to a vector of instruments. In this case, an optimization solver is unnecessary for the estimation. If the parameters are just-identified, we have</p><p class="math-container">\[\hat{\theta} = (\mathbf{Z}&#39;\mathbf{X})^{-1}\mathbf{Z}&#39;\mathbf{Y}\]</p><p>where <span>$\mathbf{Z}$</span>, <span>$\mathbf{X}$</span> and <span>$\mathbf{Y}$</span> are matrices formed by stacking <span>$\mathbf{Z}_i&#39;$</span>, <span>$\mathbf{X}_i&#39;$</span> and <span>$Y_i&#39;$</span> across observations. The parameter estimates can be obtained in one step by directly solving the linear problems. They are the IV estimates from linear regressions. If the parameters are over-identified, we have</p><p class="math-container">\[\hat{\theta} = (\mathbf{X}&#39;\mathbf{Z}\mathbf{W}\mathbf{Z}&#39;\mathbf{X})^{-1}
\mathbf{X}&#39;\mathbf{Z}\mathbf{W}\mathbf{Z}&#39;\mathbf{Y}\]</p><p>where <span>$\mathbf{W}$</span> is a weight matrix. The parameter estimates can be obtained iteratively as for the general nonlinear scenario. However, we directly evaluate <span>$\hat{\theta}$</span> in each iteration. The two-stage least squares (2SLS) estimator can be viewed as a special case where the weight matrix is specified as</p><p class="math-container">\[\mathbf{W} = \left(\mathbf{Z}&#39;\mathbf{Z}\right)^{-1}\]</p><p>with no further iteration conducted upon the first evaluation.</p><h2 id="Example:-Two-Stage-Least-Squares"><a class="docs-heading-anchor" href="#Example:-Two-Stage-Least-Squares">Example: Two-Stage Least Squares</a><a id="Example:-Two-Stage-Least-Squares-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Two-Stage-Least-Squares" title="Permalink"></a></h2><p>We replicate <a href="https://www.stata.com/manuals/rgmm.pdf">Example 2</a> from Stata manual for <code>gmm</code>:</p><pre><code class="language-julia hljs">using MethodOfMoments, CSV, DataFrames
# exampledata loads data from CSV files bundled with MethodOfMoments.jl
exampledata(name::Union{Symbol,String}) =
    DataFrame(CSV.read(MethodOfMoments.datafile(name), DataFrame), copycols=true)

data = exampledata(:hsng2)
vce = RobustVCE(3, 6, size(data,1))
eq = (:rent, (:hsngval, :pcturban), (:pcturban, :faminc, Symbol.(:reg, 2:4)...))
r = fit(IteratedLinearGMM, vce, data, eq, maxiter=1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearGMM with 6 moments and 3 parameters over 50 observations:
  Iterated Linear GMM estimator:
    iter   1  =&gt;  Q(θ) = 1.10916e+02  max|θ-θlast| = 1.20707e+02
                  Jstat = NaN        Pr(&gt;J) = NaN
  Heteroskedasticity-robust covariance estimator
────────────────────────────────────────────────────────────────────────────────
              Estimate    Std. Error     z  Pr(&gt;|z|)     Lower 95%     Upper 95%
────────────────────────────────────────────────────────────────────────────────
hsngval     0.00223983   0.000672003  3.33    0.0009   0.000922731    0.00355693
pcturban    0.081516     0.444594     0.18    0.8545  -0.789872       0.952904
cons      120.707       15.2555       7.91    &lt;1e-14  90.8064       150.607
────────────────────────────────────────────────────────────────────────────────</code></pre><p>Notice that we have specified the estimator by passing <code>IteratedLinearGMM</code> as the first argument. However, for 2SLS estimation, we restrict <code>maxiter=1</code> to avoid further iterations. The regression equation is specified as a <code>Tuple</code> of three elements where the first one is the column name of the outcome variable in <code>data</code>. The second and third elements are the names of endogenous variables and IVs respectively. Unless a keyword of <code>nocons</code> is specified, a constant term named <code>cons</code> is added automatically for the endogenous variables and IVs. The default initial weight matrix for <code>IteratedLinearGMM</code> is the one that gives us 2SLS estimates.</p><div class="admonition is-warning" id="Warning-1cdaa11af1ad6327"><header class="admonition-header">Warning<a class="admonition-anchor" href="#Warning-1cdaa11af1ad6327" title="Permalink"></a></header><div class="admonition-body"><p>The implementation of the estimator does not handle multicollinearity issues. In case some of the regressors are highly correlated, the estimator may fail to generate a result.</p></div></div><h2 id="GMMIVexample"><a class="docs-heading-anchor" href="#GMMIVexample">Example: GMM IV Estimation with Clustering</a><a id="GMMIVexample-1"></a><a class="docs-heading-anchor-permalink" href="#GMMIVexample" title="Permalink"></a></h2><p>We replicate <a href="https://www.stata.com/manuals/rivregress.pdf">Example 4</a> from Stata manual for <code>ivregress</code>:</p><pre><code class="language-julia hljs">data = exampledata(:nlswork)
data[!,:age2] = data.age.^2
dropmissing!(data, [:ln_wage, :age, :birth_yr, :grade, :tenure, :union, :wks_work, :msp])
vce = ClusterVCE(data, :idcode, 6, 8)
eq = (:ln_wage, (:tenure=&gt;[:union, :wks_work, :msp], :age, :age2, :birth_yr, :grade))
r = fit(IteratedLinearGMM, vce, data, eq, maxiter=2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearGMM with 8 moments and 6 parameters over 18625 observations:
  Iterated Linear GMM estimator:
    iter   2  =&gt;  Q(θ) = 6.38275e-04  max|θ-θlast| = 5.04467e-02
                  Jstat = 11.89        Pr(&gt;J) = 0.0026
  Cluster-robust covariance estimator: idcode
────────────────────────────────────────────────────────────────────────────────
              Estimate   Std. Error      z  Pr(&gt;|z|)     Lower 95%     Upper 95%
────────────────────────────────────────────────────────────────────────────────
tenure     0.099221     0.00377642   26.27    &lt;1e-99   0.0918194     0.106623
age        0.0171146    0.00668953    2.56    0.0105   0.00400338    0.0302259
age2      -0.000519104  0.000110954  -4.68    &lt;1e-05  -0.000736571  -0.000301637
birth_yr  -0.00859937   0.00219321   -3.92    &lt;1e-04  -0.012898     -0.00430076
grade      0.071574     0.0029938    23.91    &lt;1e-99   0.0657062     0.0774417
cons       0.857507     0.161627      5.31    &lt;1e-06   0.540723      1.17429
────────────────────────────────────────────────────────────────────────────────</code></pre><p>Here we make use of the cluster-robust VCE via <code>ClusterVCE</code> and specify <code>idcode</code> as the variable that identifies the clusters. The regression equation is specified in an alternative format with a <code>Tuple</code> only containing two elements. The first element is still the name of the outcome variable. The second element contains the names of all the regressors, with the endogenous variable <code>tenure</code> being paired with a vector of IVs.</p><h2 id="Example:-System-of-Simultaneous-Equations"><a class="docs-heading-anchor" href="#Example:-System-of-Simultaneous-Equations">Example: System of Simultaneous Equations</a><a id="Example:-System-of-Simultaneous-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-System-of-Simultaneous-Equations" title="Permalink"></a></h2><p>It is possible to specify a system of equations that are estimated jointly. We consider a modified <a href="https://www.stata.com/manuals/rgmm.pdf">Example 16</a> from Stata manual for <code>gmm</code>, replacing the variance-covariance estimator with <code>RobustVCE</code>:<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p><pre><code class="language-julia hljs">data = exampledata(:klein)
vce = RobustVCE(7, 8, nrow(data))
eqs = [(:consump, (:wagepriv, :wagegovt), (:wagegovt, :govt, :capital1)),
    (:wagepriv, (:consump, :govt, :capital1), (:wagegovt, :govt, :capital1))]
r = fit(IteratedLinearGMM, vce, data, eqs, maxiter=2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearGMM with 8 moments and 7 parameters over 22 observations:
  Iterated Linear GMM estimator:
    iter   2  =&gt;  Q(θ) = 5.60704e-02  max|θ-θlast| = 4.39993e+00
                  Jstat = 1.23        Pr(&gt;J) = 0.2667
  Heteroskedasticity-robust covariance estimator
───────────────────────────────────────────────────────────────────────────────────
                     Estimate  Std. Error      z  Pr(&gt;|z|)    Lower 95%   Upper 95%
───────────────────────────────────────────────────────────────────────────────────
consump_wagepriv    0.778481    0.0660542  11.79    &lt;1e-31    0.649018    0.907945
consump_wagegovt    0.974761    0.23845     4.09    &lt;1e-04    0.507407    1.44212
consump_cons       20.5013      2.05553     9.97    &lt;1e-22   16.4726     24.5301
wagepriv_consump    0.427942    0.198266    2.16    0.0309    0.0393469   0.816537
wagepriv_govt       1.11404     0.388362    2.87    0.0041    0.352861    1.87521
wagepriv_capital1  -0.0255532   0.0547334  -0.47    0.6406   -0.132829    0.0817223
wagepriv_cons      12.8435     11.6789      1.10    0.2715  -10.0468     35.7338
───────────────────────────────────────────────────────────────────────────────────</code></pre><p>For multiple equations, we simply need to collect the specification for each equation in a vector. The name of each parameter is prepended by its corresponding outcome variable in order to distinguish the equation it belongs to.</p><h2 id="Example:-Just-Identified-IV-Regression"><a class="docs-heading-anchor" href="#Example:-Just-Identified-IV-Regression">Example: Just-Identified IV Regression</a><a id="Example:-Just-Identified-IV-Regression-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Just-Identified-IV-Regression" title="Permalink"></a></h2><p>Lastly, we illustrate the use of the specialized estimator <code>JustIdentifiedLinearGMM</code> for the just-identified linear GMM using the <code>auto</code> dataset from Stata:</p><pre><code class="language-julia hljs">data = exampledata(:auto)
vce = RobustVCE(3, 3, size(data,1))
eq = (:mpg, [:weight, :length=&gt;:trunk])
r = fit(JustIdentifiedLinearGMM, vce, data, eq)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearGMM with 3 moments and 3 parameters over 74 observations:
  Just-identified linear GMM estimator
  Heteroskedasticity-robust covariance estimator
──────────────────────────────────────────────────────────────────────────
           Estimate   Std. Error      z  Pr(&gt;|z|)   Lower 95%    Upper 95%
──────────────────────────────────────────────────────────────────────────
weight  -0.00298026   0.00454921  -0.66    0.5124  -0.0118966   0.00593603
length  -0.111738     0.156728    -0.71    0.4759  -0.41892     0.195444
cons    51.2953      15.7791       3.25    0.0012  20.3689     82.2217
──────────────────────────────────────────────────────────────────────────</code></pre><div class="admonition is-info" id="Note-e3f19040db14939"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-e3f19040db14939" title="Permalink"></a></header><div class="admonition-body"><p>The familiar OLS regression is estimated if we omit the IV in this example.</p></div></div><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Identical estimates can be produced in Stata by changing the <code>wmatrix</code> option to <code>wmatrix(robust)</code>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../nonlineargmm/">« Generalized Method of Moments</a><a class="docs-footer-nextpage" href="../cugmm/">Continuous-Updating GMM »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Sunday 21 September 2025 05:35">Sunday 21 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
